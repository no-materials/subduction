---
id: sc-f257
status: closed
deps: []
links: []
created: 2026-02-13T16:31:28Z
type: bug
priority: 0
assignee: Bruce Mitchener
tags: [correctness, layer-store]
---
# Reject operations on destroyed LayerId handles

LayerStore::validate checks index+generation but not live-slot status. A handle can still pass validation after destroy_layer until slot reuse, allowing reads/writes on freed slots.

## Acceptance Criteria

All LayerStore public APIs reject destroyed handles; validate includes liveness check; regression tests cover getter+setter calls after destroy.


## Notes

**2026-02-13T16:33:35Z**

Plan anchors: plan.md:223-236 and plan2.md:242-255 (generation + free-list model). Current risk: validate accepts generation-match even when slot is freed. Fix direction: introduce is_slot_live(idx) and require it in validate; all public getters/setters/topology methods should fail on destroyed IDs until create_layer reuses and bumps generation. Add regression tests for getter, setter, and topology op after destroy.
